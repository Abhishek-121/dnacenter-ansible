- hosts: dnac_servers
  vars_files:
    - credentials_245.yml
  gather_facts: no
  connection: local
  tasks:
#
# Project Info  Section
#

    - name: Create Credentials and assign it to a site.
      cisco.dnac.device_credential_intent:
        dnac_host: "{{ dnac_host }}"
        dnac_port: "{{ dnac_port }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: True
        state: merged
        config:
        - global_credential_details:
            cli_credential:
            - description: CLI1
              username: cli1
              password: "12345"
              enable_password: "12345"
              # old_description:
              # old_username:
              # id: e448ea13-4de0-406b-bc6e-f72b57ed6746 # Use this for updation or deletion
            snmp_v2c_read:
            - description: SNMPv2c Read1 # use this for deletion
              read_community: "123456"
              # old_description: # use this for updating the description
              # id: 0ee7d677-8804-43f2-8b6c-599c5f18348f # Use this for updation or deletion
            snmp_v2c_write:
            - description: SNMPv2c Write1 # use this for deletion
              write_community: "123456"
              # old_description: # use this for updating the description
              # id: a96abc1b-1fd6-41f1-8a6d-a5569c17262d # Use this for updation or deletion
            snmp_v3:
            - auth_password: "12345678" # Atleast 8 characters
              auth_type: SHA # [SHA, MD5] (SHA is recommended)
              snmp_mode: AUTHPRIV # [AUTHPRIV, AUTHNOPRIV, NOAUTHNOPRIV]
              privacy_password: "12345678" # Atleast 8 characters
              privacy_type: AES128 # [AE128, AE192, AE256]
              username: snmpV31
              description: snmpV31
              # old_description:
              # id: d8974823-250a-41b0-8c9b-b27b2ae01472 # Use this for updation or deletion
            https_read:
            - description: HTTP Read1
              username: HTTP_Read1
              password: "12345"
              port: 443
              # old_description:
              # old_username:
              # id: a7ef9995-e404-4240-94ca-b5f37f65c19d # Use this for updation or deletion
            https_write:
            - description: HTTP Write1
              username: HTTP_Write1
              password: "12345"
              port: 443
              # old_description:
              # old_username:
              # id: bec9818e-30cd-468b-bf75-292beefc2e20 # Use this for updation or deletion
          assign_credentials_to_site:
            cli_credential:
              # description: CLI
              # username: cli
              id: e448ea13-4de0-406b-bc6e-f72b57ed6746
            snmp_v2c_read:
              # description: SNMPv2c Read
              id: 0ee7d677-8804-43f2-8b6c-599c5f18348f
            snmp_v2c_write:
              # description: SNMPv2c Write
              id: a96abc1b-1fd6-41f1-8a6d-a5569c17262d
            snmp_v3:
              # description: snmpV3
              id: d8974823-250a-41b0-8c9b-b27b2ae01472
            https_read:
              # description: HTTP Read
              # username: HTTP_Read
              id: d5d7af00-5a38-4ac1-9f55-03338d00c415
            https_write:
              # description: HTTP Write
              # username: HTTP_Write
              id: bec9818e-30cd-468b-bf75-292beefc2e20
            site_name:
            - Global/Chennai/Trill
            - Global/Chennai/Tidel

    - name: Delete Credentials
      cisco.dnac.device_credential_intent:
        dnac_host: "{{ dnac_host }}"
        dnac_port: "{{ dnac_port }}"
        dnac_username: "{{ dnac_username }}"
        dnac_password: "{{ dnac_password }}"
        dnac_verify: "{{ dnac_verify }}"
        dnac_debug: "{{ dnac_debug }}"
        dnac_log: True
        state: deleted
        config:
        - global_credential_details:
            cli_credential:
            - description: CLI1
              username: cli1
            snmp_v2c_read:
            - description: SNMPv2c Read1 # use this for deletion
            snmp_v2c_write:
            - description: SNMPv2c Write1 # use this for deletion
            snmp_v3:
            - description: snmpV31
            https_read:
            - description: HTTP Read1
              username: HTTP_Read1
            https_write:
            - description: HTTP Write1
              username: HTTP_Write1
